/*! For license information please see table-selection.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.TableSelection=t():e.TableSelection=t()}(self,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{default:()=>i});var n=function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},r=function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function a(e){try{i(r.next(e))}catch(e){l(e)}}function s(e){try{i(r.throw(e))}catch(e){l(e)}}function i(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}i((r=r.apply(e,t||[])).next())}))},o=function(e,t){var n,r,o,l,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return l={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function s(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},l=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,l=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=l.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=l.return)&&n.call(l)}finally{if(o)throw o.error}}return a},a=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,l=t.length;o<l;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},s={copyOnSelection:!1,rootDocument:document,selector:".table-selection",selectionCssMode:"style",selectionCssClass:"selected"};const i=function(){function e(e){void 0===e&&(e=s);var t=this;this.range=null,this.config=n({},e);var r=this.config.rootDocument,o=r.createElement("style");o.innerHTML="".concat(this.config.selector," *::selection {\n            background: transparent;\n            color: inherit;\n        }"),r.head.appendChild(o),r.addEventListener("selectionchange",(function(){return t.onSelectionChange()})),r.addEventListener("copy",(function(e){return t.handleCopy(e)}))}return e.prototype.onSelectionChange=function(){return r(this,void 0,void 0,(function(){var e,t,n,r,l,a;return o(this,(function(o){switch(o.label){case 0:return e=this.config.rootDocument.getSelection(),this.deselect(),!e||e.isCollapsed?[2]:(t=this.getCellElementFromNode(e.anchorNode),n=this.getCellElementFromNode(e.focusNode),t&&n?(r=this.getTableElementsFromCellElement(t),l=this.getTableElementsFromCellElement(n),r&&l&&r.table===l.table?(this.elements=r,this.getRangeByStartAndEndElement(t,n),this.getRowElements(),this.getRowsAndCells(),this.range?this.config.copyOnSelection?(a=this.getSelectionText(this.range),[4,this.copyToClipboard(a)]):[3,2]:[3,3]):[2]):[2]);case 1:o.sent(),o.label=2;case 2:return this.select(),[3,4];case 3:this.deselect(),o.label=4;case 4:return[2]}}))}))},e.prototype.getRangeByStartAndEndElement=function(e,t){var n,r,o=e.parentElement,a=t.parentElement;o&&a&&(this.range={start:{row:o.rowIndex+1,cell:e.cellIndex+1},end:{row:a.rowIndex+1,cell:t.cellIndex+1},rowElements:[],rows:[],cells:[]},this.range.start.cell>this.range.end.cell&&(n=l([this.range.end.cell,this.range.start.cell],2),this.range.start.cell=n[0],this.range.end.cell=n[1]),this.range.start.row>this.range.end.row&&(r=l([this.range.end.row,this.range.start.row],2),this.range.start.row=r[0],this.range.end.row=r[1]))},e.prototype.getRowElements=function(){if(this.range&&this.elements.table){var e=this.elements.table.querySelectorAll("thead tr").length,t=[],n=[],r=this.range.start.row<=e?Math.min(e,this.range.start.row):null,o=this.range.start.row<=e?Math.min(e,this.range.end.row):null,s=this.range.end.row>e?Math.max(1,this.range.start.row-e):null,i=this.range.end.row>e?Math.max(1,this.range.end.row-e):null;r&&(t=Array.from(this.elements.table.querySelectorAll("thead tr:nth-of-type(n+".concat(r,"):nth-of-type(-n+").concat(o,")")))),s&&(n=Array.from(this.elements.table.querySelectorAll("tbody tr:nth-of-type(n+".concat(s,"):nth-of-type(-n+").concat(i,")")))),this.range.rowElements=a(a([],l(t),!1),l(n),!1)}},e.prototype.getRowsAndCells=function(){var e=this;if(this.range&&this.range.rowElements){var t=[];this.range.rowElements.forEach((function(n,r){if(e.range){var o=Array.from(n.querySelectorAll(["td:nth-of-type(n+".concat(e.range.start.cell,"):nth-of-type(-n+").concat(e.range.end.cell,")"),"th:nth-of-type(n+".concat(e.range.start.cell,"):nth-of-type(-n+").concat(e.range.end.cell,")")].join(",")));t=a(a([],l(t),!1),l(o),!1),e.range.rows[r]=o}})),this.range.cells=t}},e.prototype.getCellElementFromNode=function(e){if(!e)return null;var t="#text"===e.nodeName?e.parentElement.closest("td,th"):e;return t&&["TD","TH"].includes(t.tagName)?t:null},e.prototype.getTableElementsFromCellElement=function(e){if(!e||!e.parentElement||!e.parentElement.parentElement)return null;var t=e.parentElement.parentElement,n=["TBODY","THEAD"].includes(t.tagName)?t.parentElement:t;return n&&this.config.selector&&n.matches(this.config.selector)?{table:n,thead:n.querySelector("thead"),tbody:n.querySelector("tbody")}:null},e.prototype.select=function(){var e=this;this.range&&this.range.cells&&this.range.cells.forEach((function(t){"cssClass"===e.config.selectionCssMode&&e.config.selectionCssClass?t.classList.add(e.config.selectionCssClass):(t.style.backgroundColor="var(--table-selection-background-color, Highlight)",t.style.color="var(--table-selection-color, HighlightText)")}))},e.prototype.deselect=function(){var e=this;this.range&&this.range.cells&&(this.range.cells.forEach((function(t){"cssClass"===e.config.selectionCssMode&&e.config.selectionCssClass?t.classList.remove(e.config.selectionCssClass):(t.style.removeProperty("background-color"),t.style.removeProperty("color"))})),this.range=null)},e.prototype.handleCopy=function(e){if(this.range&&this.range.rows&&e.clipboardData){var t=this.getSelectionText(this.range);t&&(e.clipboardData.setData("text/plain",t),e.preventDefault())}},e.prototype.getSelectionText=function(e){for(var t=e.rows.length,n=e.rows[0].length,r=[],o=0;o<t;o++){r.push([]);for(var l=0;l<n;l++)r[o].push(e.rows[o][l].innerText.trim())}var a=this.mergeCellTexts(r),s=this.manipulateMergedCellTexts(a);return console.log("cellTexts"),console.log(r),console.log("mergedCellTexts"),console.log(a),console.log("manipulatedMergedCellTexts"),console.log(s),s.map((function(e){return e.join("\t")})).join("\r\n")},e.prototype.manipulateMergedCellTexts=function(e){for(var t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++)e[t][n]=this.manipulateString(e[t][n]);return e},e.prototype.manipulateString=function(e){return(e=e.replace(/[-–—]/g,"0")).includes("(")&&!e.includes(")")&&(e=e.replace("(","-")),e},e.prototype.canMergeCells=function(e,t,n){if(void 0===n&&(n=["$","%","bps","pts"]),""===e||""===t)return!0;var r=function(e){return n.some((function(t){return e.includes(t)}))},o=function(e){return/^[0-9.,()-]+$/.test(e)};return!(!r(e)||!o(t))||(!(!r(t)||!o(e))||/^\(\$?\d{1,3}(,\d{3})*(\.\d+)?\)%?$/.test(e+t))},e.prototype.canMergeColumns=function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!this.canMergeCells(e[n],t[n]))return!1;return!0},e.prototype.mergeColumns=function(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e[r]+t[r]);return n},e.prototype.mergeCellTexts=function(e){e.length;var t=e[0].length;if(!e.every((function(e){return e.length===t})))throw new Error("cellTexts is not rectangular");for(var n=[e.map((function(e){return e[0]}))],r=function(t){var r=n[n.length-1],l=e.map((function(e){return e[t]}));o.canMergeColumns(r,l)?n[n.length-1]=o.mergeColumns(r,l):n.push(l)},o=this,l=1;l<t;l++)r(l);var a=[],s=function(e){a.push(n.map((function(t){return t[e]})))};for(l=0;l<n[0].length;l++)s(l);return a},e.prototype.copyToClipboard=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return null===(t=this.config.rootDocument.defaultView)?(console.warn("TableSelection: Could not access window, aborting copy to clipboard!"),[2]):[4,t.navigator.clipboard.writeText(e)];case 1:return n.sent(),void 0!==this.config.copyOnSelectionCallback&&this.config.copyOnSelectionCallback(e),[2]}}))}))},e}();return t.default})()));
//# sourceMappingURL=table-selection.min.js.map